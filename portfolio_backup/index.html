<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI GALLERY - Futuristic AI Generated Art</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Preload critical images -->
    <link rel="preload" href="images/top/top_01.webp" as="image">
    <link rel="preload" href="images/top/top_02.webp" as="image">
    <link rel="preload" href="images/top/top_03.webp" as="image">
    <link rel="preload" href="images/top/top_09.webp" as="image">
    
    <!-- Inline critical CSS -->
    <style>
        /* Critical CSS for above-the-fold content */
        body { margin: 0; font-family: 'Rajdhani', sans-serif; overflow-x: hidden; }
    </style>
    
    <!-- Non-critical CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body style="margin: 0; padding: 0; overflow-x: hidden;">
    <!-- Loading Animation -->
    <div class="loading-animation">
        <div class="loading-content">
            <div class="loading-logo">TK</div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <div class="loading-text">INITIALIZING PORTFOLIO...</div>
        </div>
    </div>

    <!-- Global Particle Background -->
    <div class="global-particles-container"></div>
    
    <header class="main-header">
        <div class="container">
            <div class="logo">AI<span>GALLERY</span></div>
            <nav class="main-nav">
                <ul>
                    <li class="nav-item"><a href="#top">TOP</a></li>
                    <li class="nav-item"><a href="#about">PROFILE</a></li>
                    <li class="nav-item"><a href="#works">WORKS</a></li>
                    <li class="nav-item"><a href="#category">CATEGORY</a></li>
                    <li class="nav-item"><a href="#contact">CONTACT</a></li>
                </ul>
            </nav>
            <div class="menu-toggle">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="top" class="hero-section">
            <div class="hero-slideshow-background">
                <!-- Fantasy -->
                <div class="slideshow-slide">
                    <img src="images/fantasy/fantasy_01.webp" alt="Fantasy Art 1" loading="lazy">
                </div>
                <div class="slideshow-slide">
                    <img src="images/fantasy/fantasy_02.webp" alt="Fantasy Art 2" loading="lazy">
                </div>
                <!-- Sci-Fi -->
                <div class="slideshow-slide">
                    <img src="images/sf/sf_01.webp" alt="Sci-Fi Art 1" loading="lazy">
                </div>
                <div class="slideshow-slide">
                    <img src="images/sf/sf_02.webp" alt="Sci-Fi Art 2" loading="lazy">
                </div>
                <!-- Anime -->
                <div class="slideshow-slide">
                    <img src="images/anime/anime_01.webp" alt="Anime Art 1" loading="lazy">
                </div>
                <div class="slideshow-slide">
                    <img src="images/anime/anime_02.webp" alt="Anime Art 2" loading="lazy">
                </div>
                <!-- Portrait -->
                <div class="slideshow-slide">
                    <img src="images/portrait/portrait_01.webp" alt="Portrait Art 1" loading="lazy">
                </div>
                <div class="slideshow-slide">
                    <img src="images/portrait/portrait_02.webp" alt="Portrait Art 2" loading="lazy">
                </div>
                <!-- Landscape -->
                <div class="slideshow-slide">
                    <img src="images/landscape/landscape_01.webp" alt="Landscape Art 1" loading="lazy">
                </div>
                <div class="slideshow-slide">
                    <img src="images/landscape/landscape_02.webp" alt="Landscape Art 2" loading="lazy">
                </div>
            </div>
            <div class="hero-overlay"></div>
            </div>
            <div class="container hero-container">
                <div class="hero-content">
                    <h1 class="hero-title fade-in">FUTURE VISION AI</h1>
                    <p class="hero-subtitle fade-in" style="animation-delay: 0.3s;">AI生成による未来的なアート作品のポートフォリオ</p>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="about" class="about-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">PROFILE</h2>
                </div>
                
                <div class="profile-grid">
                    <div class="profile-image-container">
                        <picture>
                            <source srcset="images/top/top_03.webp" type="image/webp">
                            <img src="images/top/top_03.png" alt="Profile Image" class="profile-image primary-image" loading="lazy">
                        </picture>
                        <picture>
                            <source srcset="images/top/top_01.webp" type="image/webp">
                            <img src="images/top/top_01.png" alt="Alternative Profile Image" class="profile-image secondary-image" loading="lazy">
                        </picture>
                        <div class="profile-image-glow"></div>
                    </div>
                    
                    <div class="profile-content">
                        <div class="name-container">
                            <h2 class="profile-name">TK</h2>
                            <div class="profile-job">AI CREATOR</div>
                        </div>
                        <div class="about-text">
                            <p>
                                はじめまして、TKと申します。AIを活用したデジタルアート制作を専門としています。
                                情報系の学校を卒業後、テクノロジーとアートの融合に関心を持ち、AIによる創作活動を始めました。
                                Midjourneyを中心とした画像生成技術を得意としており、サイバーパンクやニューロマンサーの世界観に影響を受けた、未来的で幻想的な作品を制作しています。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Works Section -->
        <section id="works" class="works-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">WORKS</h2>
                    <p class="works-subtitle">お客様のニーズに応じた幅広いサービスをご提供</p>
                </div>
                
                <div class="works-grid">
                    <!-- AI画像生成 -->
                    <div class="work-card">
                        <div class="work-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <h3 class="work-title">AI画像生成</h3>
                        <p class="work-description">
                            最新のAI技術を駆使し、お客様のビジョンを高品質な画像として実現します。
                            商用利用可能な独自イラスト、キャラクターデザイン、アートワークなど、
                            あらゆるニーズにお応えします。
                        </p>
                        <div class="work-features">
                            <span class="feature-tag">キャラクターデザイン</span>
                            <span class="feature-tag">商品イメージ</span>
                            <span class="feature-tag">アートワーク</span>
                        </div>

                    </div>
                    
                    <!-- オリジナルグッズ作成 -->
                    <div class="work-card">
                        <div class="work-icon">
                            <i class="fas fa-tshirt"></i>
                        </div>
                        <h3 class="work-title">オリジナルグッズ作成</h3>
                        <p class="work-description">
                            AI生成画像を活用したオリジナルグッズの企画・制作を行います。
                            Tシャツ、ステッカー、アクリルスタンドなど、多様なアイテムに対応。
                            個人から企業まで幅広くサポートいたします。
                        </p>
                        <div class="work-features">
                            <span class="feature-tag">Tシャツ・アパレル</span>
                            <span class="feature-tag">ステッカー</span>
                            <span class="feature-tag">アクリルスタンド</span>
                        </div>

                    </div>
                </div>
            </div>
        </section>
        

        
        <!-- Category Section -->
        <section id="category" class="category-section">
            <div class="category-particles" id="categoryParticles"></div>
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">CATEGORY</h2>
                    <p class="category-subtitle">AI生成アートを様々なジャンルで展開しています</p>
                </div>
                
                <!-- メインカテゴリー -->
                <div class="main-categories">
                    <!-- 人物（Portraits） -->
                    <a href="portrait.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/portrait/portrait_01.png" alt="人物">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>人物（Portraits）</h3>
                            <p>リアル・イラスト問わず、人間を主題にした作品。</p>
                        </div>
                    </a>
                    
                    <!-- 風景（Landscapes） -->
                    <a href="landscape.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/landscape/landscape_01.png" alt="風景">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>風景（Landscapes）</h3>
                            <p>自然、街並み、空、海など、背景・環境中心の作品。</p>
                        </div>
                    </a>
                    
                    <!-- ファンタジー（Fantasy） -->
                    <a href="fantasy.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/fantasy/fantasy_01.png" alt="ファンタジー">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>ファンタジー（Fantasy）</h3>
                            <p>異世界、魔法、神秘的な世界観を持つ作品。</p>
                        </div>
                    </a>
                    
                    <!-- SF・近未来（Sci-Fi） -->
                    <a href="sf.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/sf/sf_01.png" alt="SF・近未来">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>SF・近未来（Sci-Fi）</h3>
                            <p>サイバーパンク、宇宙、ロボットなど近未来的な世界観。</p>
                        </div>
                    </a>
                    
                    <!-- アートスタイル表現（Art Style） -->
                    <a href="illustration.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/illustration/illustration_02.png" alt="アートスタイル表現">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>アートスタイル表現（Art Style）</h3>
                            <p>水彩、油絵、コラージュ風など、表現手法そのものを楽しむ作品。</p>
                        </div>
                    </a>
                    
                    <!-- アニメ（Anime） -->
                    <a href="anime.html" class="main-category-card" data-transition="true">
                        <div class="category-image-container">
                            <img src="images/anime/anime_01.png" alt="アニメ">
                            <div class="category-overlay"></div>
                        </div>
                        <div class="category-info">
                            <h3>アニメ（Anime）</h3>
                            <p>日本のアニメスタイルから影響を受けた可愛いキャラクターデザイン。</p>
                        </div>
                    </a>
                </div>
            </div>
        </section>
        
        <!-- Contact Section -->
        <section id="contact" class="contact-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">CONTACT</h2>
                </div>
                
                <div class="contact-container">
                    <div class="contact-info-wrapper">
                        <div class="contact-info">
                            <h3>GET IN TOUCH</h3>
                            <p>AI生成映像に関するご質問や制作依頼など、お気軽にお問い合わせください。</p>
                            
                            <div class="contact-methods">
                                <div class="contact-method">
                                    <i class="fas fa-envelope"></i>
                                    <div>
                                        <span>EMAIL</span>
                                        <span>info@aigallery.com</span>
                                    </div>
                                </div>
                                
                                <div class="contact-method">
                                    <i class="fas fa-phone"></i>
                                    <div>
                                        <span>PHONE</span>
                                        <span>03-1234-5678</span>
                                    </div>
                                </div>
                                
                                <div class="contact-method">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <div>
                                        <span>LOCATION</span>
                                        <span>東京都渋谷区</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="social-icons">
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fab fa-instagram"></i></a>
                                <a href="#"><i class="fab fa-youtube"></i></a>
                                <a href="#"><i class="fab fa-linkedin"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contact-form-wrapper">
                        <form class="contact-form">
                            <div class="input-group">
                                <label for="name">NAME</label>
                                <input type="text" id="name" required>
                            </div>
                            
                            <div class="input-group">
                                <label for="email">EMAIL</label>
                                <input type="email" id="email" required>
                            </div>
                            
                            <div class="input-group">
                                <label for="subject">SUBJECT</label>
                                <input type="text" id="subject" required>
                            </div>
                            
                            <div class="input-group">
                                <label for="message">MESSAGE</label>
                                <textarea id="message" rows="5" required></textarea>
                            </div>
                            
                            <button type="submit" class="submit-button">SEND</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-logo">AI<span>GALLERY</span></div>
            
            <div class="footer-links">
                <a href="#top">TOP</a>
                <a href="#about">PROFILE</a>
                <a href="#works">WORKS</a>
                <a href="#category">CATEGORY</a>
                <a href="#contact">CONTACT</a>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 AI GALLERY. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Slideshow variables
            let slideInterval;
            const slides = document.querySelectorAll('.slideshow-slide');
            let currentSlide = 0;
            
            // Loading animation
            const loadingAnimation = document.querySelector('.loading-animation');
            const loadingProgress = document.querySelector('.loading-progress');
            const loadingText = document.querySelector('.loading-text');
            
            // Ensure loading animation is visible
            loadingAnimation.style.display = 'flex';
            
            // Initialize slideshow
            function initSlideshow() {
                if (slides.length > 0) {
                    // Hide all slides initially
                    slides.forEach(slide => {
                        slide.classList.remove('active');
                    });
                    // Show first slide
                    slides[0].classList.add('active');
                }
            }
            
            // Function to show next slide
            function showNextSlide() {
                if (slides.length === 0) return;
                
                // Hide current slide
                slides[currentSlide].classList.remove('active');
                
                // Move to next slide
                currentSlide = (currentSlide + 1) % slides.length;
                
                // Show next slide
                slides[currentSlide].classList.add('active');
            }
            
            // Start slideshow
            function startSlideshow() {
                // Show first slide immediately
                if (slides.length > 0) {
                    // First slide shows for 5 seconds, then switch to 3-second intervals
                    setTimeout(() => {
                        showNextSlide();
                        slideInterval = setInterval(showNextSlide, 3000); // Change slide every 3 seconds after first transition
                    }, 5000); // First slide shows for 5 seconds
                }
            }
            
            // Initialize slideshow
            initSlideshow();
            
            // Animate loading progress
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                loadingProgress.style.width = `${progress}%`;
                
                // Update loading text
                if (progress < 30) {
                    loadingText.textContent = 'LOADING ASSETS...';
                } else if (progress < 70) {
                    loadingText.textContent = 'INITIALIZING...';
                } else {
                    loadingText.textContent = 'ALMOST THERE...';
                }
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    loadingText.textContent = 'READY!';
                    
                    // Fade out loading animation
                    loadingAnimation.classList.add('fade-out');
                    
                    // Enable scrolling and show content
                    document.body.style.overflow = 'auto';
                    document.documentElement.style.overflow = 'auto';
                    
                    // Animate hero section
                    const heroSection = document.querySelector('.hero-section');
                    if (heroSection) {
                        heroSection.style.opacity = '0';
                        heroSection.style.transform = 'translateY(20px)';
                        heroSection.style.transition = 'opacity 0.8s ease-out 0.3s, transform 0.8s ease-out 0.3s';
                    }
                    
                    // Remove loading animation after fade out
                    setTimeout(() => {
                        loadingAnimation.style.display = 'none';
                        
                        // Animate hero section in
                        if (heroSection) {
                            heroSection.style.opacity = '1';
                            heroSection.style.transform = 'translateY(0)';
                            
                            // Add fade-in class to hero text after a short delay
                            setTimeout(() => {
                                const heroTitle = document.querySelector('.hero-title');
                                const heroSubtitle = document.querySelector('.hero-subtitle');
                                
                                if (heroTitle) heroTitle.classList.add('fade-in');
                                if (heroSubtitle) {
                                    heroSubtitle.style.animationDelay = '0.3s';
                                    heroSubtitle.classList.add('fade-in');
                                }
                            }, 100);
                        }
                        
                        // Add scroll reveal animation to other sections
                        const sections = document.querySelectorAll('section:not(.hero-section)');
                        sections.forEach((section, index) => {
                            section.style.opacity = '0';
                            section.style.transform = 'translateY(30px)';
                            section.style.transition = `opacity 0.6s ease-out ${0.3 + index * 0.1}s, transform 0.6s ease-out ${0.3 + index * 0.1}s`;
                            
                            // Trigger reflow
                            void section.offsetHeight;
                            
                            section.style.opacity = '1';
                            section.style.transform = 'translateY(0)';
                        });
                    }, 500);
                }
            }, 100);
            
            // Dynamic Hero Animations
            // Header scroll effect
            const header = document.querySelector('.main-header');
            const profileSection = document.querySelector('#about');
            
            function handleScroll() {
                const profileOffset = profileSection.offsetTop;
                const scrollPosition = window.scrollY;
                
                if (scrollPosition >= profileOffset - 100) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            }
            
            window.addEventListener('scroll', handleScroll);
            
            // Mobile menu toggle
            const menuToggle = document.querySelector('.menu-toggle');
            const mainNav = document.querySelector('.main-nav');
            
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                mainNav.classList.toggle('active');
            });
            
            // Generate Particles for global container
            function createGlobalParticles() {
                const particlesContainer = document.querySelector('.global-particles-container');
                const particleCount = 150; // 粒子を増やす
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('particle');
                    
                    // Random size and position
                    const size = Math.random() * 4 + 1;
                    const posX = Math.random() * 100;
                    const posY = Math.random() * 100;
                    const delay = Math.random() * 20;
                    const duration = Math.random() * 10 + 10;
                    
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    particle.style.left = `${posX}%`;
                    particle.style.top = `${posY}%`;
                    particle.style.animationDelay = `${delay}s`;
                    particle.style.animationDuration = `${duration}s`;
                    
                    particlesContainer.appendChild(particle);
                }
            }
            
            // Generate Particles for category section
            function createCategoryParticles() {
                const particlesContainer = document.querySelector('#categoryParticles');
                if (!particlesContainer) return;
                
                const particleCount = 80; // カテゴリーセクション用の粒子数
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('category-particle');
                    
                    // Random size and position
                    const size = Math.random() * 6 + 2;
                    const posX = Math.random() * 100;
                    const posY = Math.random() * 100;
                    const delay = Math.random() * 15;
                    const duration = Math.random() * 20 + 15;
                    
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    particle.style.left = `${posX}%`;
                    particle.style.top = `${posY}%`;
                    particle.style.animationDelay = `${delay}s`;
                    particle.style.animationDuration = `${duration}s`;
                    
                    particlesContainer.appendChild(particle);
                }
            }
            
            // Gallery Modal functionality
            function initGalleryModal() {
                const galleryItems = document.querySelectorAll('.gallery-item');
                const modal = document.getElementById('gallery-modal');
                const modalImage = document.getElementById('modal-image');
                const modalTitle = document.getElementById('modal-title');
                const modalDescription = document.getElementById('modal-description');
                const closeModal = document.querySelector('.close-modal');
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');
                
                let currentImageIndex = 0;
                const images = [];
                
                // Collect all gallery images
                galleryItems.forEach((item, index) => {
                    const img = item.querySelector('img');
                    const title = item.querySelector('.gallery-content h3').textContent;
                    const description = item.querySelector('.gallery-content p').textContent;
                    
                    images.push({
                        src: img.src,
                        alt: img.alt,
                        title: title,
                        description: description
                    });
                    
                    item.addEventListener('click', () => {
                        currentImageIndex = index;
                        showModal();
                    });
                });
                
                function showModal() {
                    const image = images[currentImageIndex];
                    modalImage.src = image.src;
                    modalImage.alt = image.alt;
                    modalTitle.textContent = image.title;
                    modalDescription.textContent = image.description;
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                }
                
                function hideModal() {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
                
                function showNextImage() {
                    currentImageIndex = (currentImageIndex + 1) % images.length;
                    const image = images[currentImageIndex];
                    modalImage.src = image.src;
                    modalImage.alt = image.alt;
                    modalTitle.textContent = image.title;
                    modalDescription.textContent = image.description;
                }
                
                function showPrevImage() {
                    currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
                    const image = images[currentImageIndex];
                    modalImage.src = image.src;
                    modalImage.alt = image.alt;
                    modalTitle.textContent = image.title;
                    modalDescription.textContent = image.description;
                }
                
                // Event listeners
                closeModal.addEventListener('click', hideModal);
                nextBtn.addEventListener('click', showNextImage);
                prevBtn.addEventListener('click', showPrevImage);
                
                // Close modal when clicking outside the image
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        hideModal();
                    }
                });
                
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (modal.style.display === 'flex') {
                        if (e.key === 'Escape') {
                            hideModal();
                        } else if (e.key === 'ArrowRight') {
                            showNextImage();
                        } else if (e.key === 'ArrowLeft') {
                            showPrevImage();
                        }
                    }
                });
            }
            

            
            // Slideshow functionality
            function initSlideshow() {
                const slides = document.querySelectorAll('.hero-slideshow-background .slideshow-slide');
                let currentSlide = 0;
                
                // Initialize first slide as active
                if (slides.length > 0) {
                    slides[0].classList.add('active');
                }
                
                // Function to change slide
                function changeSlide(index) {
                    // Remove active class from all slides
                    slides.forEach(slide => slide.classList.remove('active'));
                    
                    // Add active class to current slide
                    slides[index].classList.add('active');
                    currentSlide = index;
                }
                
                // Auto change slides every 3 seconds (faster for more slides)
                setInterval(() => {
                    let nextSlide = (currentSlide + 1) % slides.length;
                    changeSlide(nextSlide);
                }, 3000);
            }
            
            // Category card hover effects
            const categoryCards = document.querySelectorAll('.main-category-card');
            
            categoryCards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.querySelector('.category-info h3').style.transition = 'color 0.3s ease';
                });
            });
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        // Close mobile menu if open
                        menuToggle.classList.remove('active');
                        mainNav.classList.remove('active');
                        
                        window.scrollTo({
                            top: target.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Matrix transition for page navigation
            document.querySelectorAll('a[data-transition="true"], .category-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Skip if it's a download link or has no href
                    if (this.classList.contains('download-link') || !this.getAttribute('href')) {
                        return;
                    }

                    e.preventDefault();
                    const href = this.getAttribute('href');
                    let pageName = '';

                    // Get the page name from different possible elements
                    if (this.querySelector('h3')) {
                        pageName = this.querySelector('h3').textContent.split('（')[0].toUpperCase();
                    } else if (this.closest('.category-item')) {
                        pageName = this.closest('.category-item').querySelector('h3')?.textContent.split('（')[0].toUpperCase() || '';
                    } else if (this.textContent.trim()) {
                        pageName = this.textContent.trim().toUpperCase();
                    }

                    // Matrix transition effect
                    const matrixTransition = document.querySelector('.matrix-transition');
                    const matrixContent = document.querySelector('.matrix-content');
                    const matrixCanvas = document.getElementById('matrix-canvas');
                    const ctx = matrixCanvas.getContext('2d');
                    
                    // Reset styles
                    matrixTransition.style.display = 'flex';
                    matrixTransition.classList.remove('hidden');
                    matrixContent.style.opacity = '0';
                    
                    // Set canvas size
                    matrixCanvas.width = window.innerWidth;
                    matrixCanvas.height = window.innerHeight;
                    
                    // Update matrix message
                    matrixContent.textContent = pageName ? `LOADING ${pageName} DATA...` : 'LOADING...';
                    
                    // Show matrix transition
                    matrixTransition.classList.add('active');
                    
                    // Matrix animation code
                    const latin = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                    const nums = '0123456789';
                    const symbols = '!@#$%^&*()_+-=[]{}|;:,./<>?';
                    const alphabet = latin + nums + symbols;
                    
                    const fontSize = 16;
                    const columns = matrixCanvas.width / fontSize;
                    
                    // 各列の開始位置（y座標）を保持する配列
                    const drops = [];
                    for (let i = 0; i < columns; i++) {
                        drops[i] = 1;
                    }
                    
                    // マトリックス効果を描画する関数
                    function drawMatrix() {
                        // 透明な黒の背景で少しずつ前のフレームを消す（残像効果）
                        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                        ctx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                        
                        // 文字の色を設定
                        ctx.fillStyle = '#00ffff'; // 蛍光ブルー
                        ctx.font = `${fontSize}px monospace`;
                        
                        // 各列について文字を描画
                        for (let i = 0; i < drops.length; i++) {
                            // ランダムな文字を選択
                            const text = alphabet.charAt(Math.floor(Math.random() * alphabet.length));
                            
                            // 文字を描画
                            ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                            
                            // 一定の確率で先頭を消去し、新しい列を開始
                            if (drops[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
                                drops[i] = 0;
                            }
                            
                            // 文字を下に移動
                            drops[i]++;
                        }
                    }
                    
                    // Start matrix animation
                    let matrixInterval = setInterval(drawMatrix, 50);
                    
                    // Show content message immediately
                    setTimeout(() => {
                        matrixContent.style.opacity = '1';
                    }, 150);
                    
                    // Start page transition after a short delay for the animation to be visible
                    setTimeout(() => {
                        clearInterval(matrixInterval);
                        // Start page transition immediately
                        window.location.href = href;
                        
                        // Clean up after a short delay in case the page doesn't change
                        setTimeout(() => {
                            const matrixTransition = document.querySelector('.matrix-transition');
                            if (matrixTransition) {
                                matrixTransition.classList.add('hidden');
                                document.body.style.overflow = 'auto';
                                matrixTransition.style.display = 'none';
                            }
                        }, 500);
                    }, 300); // Reduced from 1000ms to 300ms for faster transition
                });
            });
            
            // Initialize components
            createGlobalParticles();
            createCategoryParticles();
            initGalleryModal();
            initSlideshow();
        });
    </script>

    <!-- LazySizes for lazy loading images -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js" async></script>
    
    <!-- Main Scripts -->
    <script src="js/script.js" defer></script>
    <script src="js/transitions.js" defer></script>
    
    <script>
        // Check if coming from a subpage
        const isComingFromSubpage = document.referrer && 
                                  document.referrer.includes(window.location.hostname) && 
                                  !document.referrer.endsWith('/');
        
        // Store the current page state
        sessionStorage.setItem('showMatrix', isComingFromSubpage ? 'true' : 'false');
        
        // Initialize lazysizes for images with data-src
        if ('loading' in HTMLImageElement.prototype) {
            document.addEventListener('DOMContentLoaded', () => {
                const images = document.querySelectorAll('img[loading="lazy"][data-src]');
                images.forEach(img => {
                    img.src = img.dataset.src;
                });
            });
        }
        
        // Initialize animations based on navigation
        document.addEventListener('DOMContentLoaded', function() {
            const matrixTransition = document.querySelector('.matrix-transition');
            
            // Show matrix transition only when coming from a subpage
            if (sessionStorage.getItem('showMatrix') === 'true') {
                matrixTransition.style.display = 'flex';
                
                // Hide matrix transition after animation
                setTimeout(() => {
                    matrixTransition.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                    
                    matrixTransition.addEventListener('transitionend', () => {
                        matrixTransition.style.display = 'none';
                        sessionStorage.removeItem('showMatrix');
                    }, { once: true });
                }, 1500);
            } else {
                // Ensure page is scrolled to top on initial load and scrolling is enabled
                window.scrollTo(0, 0);
                document.body.style.overflow = 'auto';
            }
            
            // Initialize Hero Slideshow
            const slides = document.querySelectorAll('.hero-slideshow-background .slideshow-slide');
            let currentSlide = 0;
            let slideInterval;

            function showNextSlide() {
                if (slides.length === 0) return;

                // Hide current slide
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.remove('active');
                }

                // Move to next slide, loop back to start if at the end
                currentSlide = (currentSlide + 1) % slides.length;
                
                // Show new slide
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.add('active');
                }
            }

            function startSlideshow() {
                // Show first slide immediately
                if (slides.length > 0) {
                    slides[0].classList.add('active');
                    // First slide shows for 5 seconds, then switch to 3-second intervals
                    setTimeout(() => {
                        showNextSlide();
                        slideInterval = setInterval(showNextSlide, 3000); // Change slide every 3 seconds after first transition
                    }, 5000); // First slide shows for 5 seconds
                }
            }

            function stopSlideshow() {
                clearInterval(slideInterval);
            }

            // Start slideshow when the page is loaded
            startSlideshow();

            // Optional: Pause slideshow when tab is not visible, resume when visible
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    stopSlideshow();
                } else {
                    startSlideshow();
                }
            });

            // Handle page transitions
            document.querySelectorAll('a[href^="/"], a[href^="./"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    // Only handle links to the top page
                    if (href.includes('index.html') || href === '/' || href === './') {
                        e.preventDefault();
                        
                        // Set flag for matrix animation on next page load
                        sessionStorage.setItem('showMatrix', 'true');
                        
                        // Navigate to the top page
                        window.location.href = href;
                    }
                });
            });
        });
    </script>
</body>
</html>